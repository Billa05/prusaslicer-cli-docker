# PrusaSlicer CLI Docker Workflow

This project provides a streamlined, terminal-based workflow for slicing 3D models using the [PrusaSlicer](https://github.com/prusa3d/PrusaSlicer) CLI, fully containerized with Docker. It leverages official PrusaSlicer configuration profiles for flexible, reproducible slicing without the GUI.

## Project Structure

- **dockerfile**: (Optional) For building your own Docker image with PrusaSlicer CLI and all dependencies.
- **PrusaSlicer/**: The main PrusaSlicer source (cloned during Docker build if building locally).
- **PrusaSlicer-settings-prusa-fff/**: Official PrusaSlicer FFF (Fused Filament Fabrication) printer/filament profiles, used for configuration.
- **models/**: Place your `.stl` or `.obj` models here.
- **config/**: Place your `.ini` config files here (e.g., `config.ini`).
- **gcode/**: Output directory for generated `.gcode` files.
- **stats/**: Output directory for slicing statistics.
- **output/**: Output directory for summary JSON files generated by `parser.py` and for any additional output formats.
- **slice.sh**: Bash script to run slicing jobs via Docker.
- **batch_slice.py**: Python script to batch/parallel slice all models in `models/` using a config file.
- **help-fff.txt**, **help-sla.txt**, **help.txt**: Full CLI help for PrusaSlicer, including all available options for FFF and SLA printing.

---

## Quick Start

### 1. Pull the Docker Image

```sh
docker pull billa05/prusacli:latest
```

### 2. Prepare Your Files
- Place your 3D model (e.g., `test_model.stl`) in the `models/` directory.
- Place your config/profile (e.g., `config.ini` or a profile from `PrusaSlicer-settings-prusa-fff/`) in the `config/` directory.
- Output G-code will be written to `gcode/`, and stats to `stats/`.

### 3. Slice a Model

Use the provided `slice.sh` script:

```sh
./slice.sh <model.stl|obj> <config.ini>
```

**Example:**
```sh
./slice.sh test_model.stl config.ini
```
- Slices `test_model.stl` using `config.ini`, outputs `gcode/test_model.gcode`, and writes slicing stats to `stats/test_model_stats.txt`.

---

## Batch/Parallel Slicing

To slice all models in the `models/` directory in parallel (using all CPU cores), use the `batch_slice.py` script:

```sh
python3 batch_slice.py
```
- This will use `config/config.ini` for all models by default. Edit the script to change the config if needed.
- Errors are logged to `error.log`.

---

## How It Works

- The Docker image contains a CLI-only build of PrusaSlicer and all required libraries.
- The `slice.sh` script mounts the `models/`, `gcode/`, `config/`, and `stats/` directories into the container, so all input/output files are accessible from your host.
- Slicing is performed entirely via the PrusaSlicer CLI, with no GUI required.
- The official PrusaSlicer FFF profiles (in `PrusaSlicer-settings-prusa-fff/`) can be used as config files for consistent, high-quality slicing.

---

## Advanced Usage

- The PrusaSlicer CLI supports a wide range of options for customizing slicing, supports, infill, and more.
- See the included help files for full documentation:
  - `help-fff.txt`: All FFF (Fused Filament Fabrication) options
  - `help-sla.txt`: All SLA (resin) options
  - `help.txt`: General CLI usage

To pass additional options, you can modify the `slice.sh` script or run the Docker command directly. For example, to change brim width or enable/disable supports, add the relevant flags (see help files for details).

---

## Parsing G-code Summaries

You can extract a summary of key statistics from a G-code file using the provided `parser.py` script. This script reads a G-code file and writes a JSON summary to the `output/` directory, regardless of the input file's location.

**Usage:**
```sh
python3 parser.py <path/to/file.gcode>
```
- The summary will be written to `output/<file>.json` (e.g., `output/dragon.json`).
> **Note:** The `output/` directory is used to store summary JSON files generated by `parser.py` (e.g., `output/dragon.json`) and can also be used for any other additional output formats you may generate.

---

## Optional: Build the Docker Image Locally

If you want to build the Docker image yourself (for development or customization), you can do so with:

```sh
docker build -t billa05/prusacli:latest .
```

This will use the provided `dockerfile` to build the image from source.

---

## References
- [PrusaSlicer GitHub](https://github.com/prusa3d/PrusaSlicer)
- [PrusaSlicer CLI Documentation](https://github.com/prusa3d/PrusaSlicer/wiki/Command-Line-Interface)
- [PrusaSlicer-settings](https://github.com/prusa3d/PrusaSlicer-settings)

